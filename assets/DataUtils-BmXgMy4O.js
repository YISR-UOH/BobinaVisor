import{o as $,T as ge}from"./vendor-danfo-DUF2pp_5.js";import{g as ke}from"./vendor-react-c5ypKtDW.js";var le={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var Le=le.exports,Ce;function ve(){return Ce||(Ce=1,(function(l,d){((c,a)=>{l.exports=a()})(Le,function c(){var a=typeof self<"u"?self:typeof window<"u"?window:a!==void 0?a:{},y,L=!a.document&&!!a.postMessage,r=a.IS_PAPA_WORKER||!1,_={},m=0,s={};function w(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(t){var n=fe(t);n.chunkSize=parseInt(n.chunkSize),t.step||t.chunk||(n.chunkSize=null),this._handle=new ce(n),(this._handle.streamer=this)._config=n}).call(this,e),this.parseChunk=function(t,n){var o=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<o){let D=this._config.newline;D||(i=this._config.quoteChar||'"',D=this._handle.guessLineEndings(t,i)),t=[...t.split(D).slice(o)].join(D)}this.isFirstChunk&&R(this._config.beforeFirstChunk)&&(i=this._config.beforeFirstChunk(t))!==void 0&&(t=i),this.isFirstChunk=!1,this._halted=!1;var o=this._partialLine+t,i=(this._partialLine="",this._handle.parse(o,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(t=i.meta.cursor,o=(this._finished||(this._partialLine=o.substring(t-this._baseIndex),this._baseIndex=t),i&&i.data&&(this._rowCount+=i.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),r)a.postMessage({results:i,workerId:s.WORKER_ID,finished:o});else if(R(this._config.chunk)&&!n){if(this._config.chunk(i,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=i=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(i.data),this._completeResults.errors=this._completeResults.errors.concat(i.errors),this._completeResults.meta=i.meta),this._completed||!o||!R(this._config.complete)||i&&i.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),o||i&&i.meta.paused||this._nextChunk(),i}this._halted=!0},this._sendError=function(t){R(this._config.error)?this._config.error(t):r&&this._config.error&&a.postMessage({workerId:s.WORKER_ID,error:t,finished:!1})}}function H(e){var t;(e=e||{}).chunkSize||(e.chunkSize=s.RemoteChunkSize),w.call(this,e),this._nextChunk=L?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(n){this._input=n,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),L||(t.onload=ne(this._chunkLoaded,this),t.onerror=ne(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!L),this._config.downloadRequestHeaders){var n,o=this._config.downloadRequestHeaders;for(n in o)t.setRequestHeader(n,o[n])}var i;this._config.chunkSize&&(i=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+i));try{t.send(this._config.downloadRequestBody)}catch(D){this._chunkError(D.message)}L&&t.status===0&&this._chunkError()}},this._chunkLoaded=function(){t.readyState===4&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(n=>(n=n.getResponseHeader("Content-Range"))!==null?parseInt(n.substring(n.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(n){n=t.statusText||n,this._sendError(new Error(n))}}function v(e){(e=e||{}).chunkSize||(e.chunkSize=s.LocalChunkSize),w.call(this,e);var t,n,o=typeof FileReader<"u";this.stream=function(i){this._input=i,n=i.slice||i.webkitSlice||i.mozSlice,o?((t=new FileReader).onload=ne(this._chunkLoaded,this),t.onerror=ne(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var i=this._input,D=(this._config.chunkSize&&(D=Math.min(this._start+this._config.chunkSize,this._input.size),i=n.call(i,this._start,D)),t.readAsText(i,this._config.encoding));o||this._chunkLoaded({target:{result:D}})},this._chunkLoaded=function(i){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(i.target.result)},this._chunkError=function(){this._sendError(t.error)}}function F(e){var t;w.call(this,e=e||{}),this.stream=function(n){return t=n,this._nextChunk()},this._nextChunk=function(){var n,o;if(!this._finished)return n=this._config.chunkSize,t=n?(o=t.substring(0,n),t.substring(n)):(o=t,""),this._finished=!t,this.parseChunk(o)}}function I(e){w.call(this,e=e||{});var t=[],n=!0,o=!1;this.pause=function(){w.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){w.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(i){this._input=i,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){o&&t.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):n=!0},this._streamData=ne(function(i){try{t.push(typeof i=="string"?i:i.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(D){this._streamError(D)}},this),this._streamError=ne(function(i){this._streamCleanUp(),this._sendError(i)},this),this._streamEnd=ne(function(){this._streamCleanUp(),o=!0,this._streamData("")},this),this._streamCleanUp=ne(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function ce(e){var t,n,o,i,D=Math.pow(2,53),N=-D,G=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,J=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,E=this,P=0,h=0,q=!1,p=!1,O=[],u={data:[],errors:[],meta:{}};function W(C){return e.skipEmptyLines==="greedy"?C.join("").trim()==="":C.length===1&&C[0].length===0}function j(){if(u&&o&&(Y("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+s.DefaultDelimiter+"'"),o=!1),e.skipEmptyLines&&(u.data=u.data.filter(function(f){return!W(f)})),U()){let f=function(M,z){R(e.transformHeader)&&(M=e.transformHeader(M,z)),O.push(M)};if(u)if(Array.isArray(u.data[0])){for(var C=0;U()&&C<u.data.length;C++)u.data[C].forEach(f);u.data.splice(0,1)}else u.data.forEach(f)}function k(f,M){for(var z=e.header?{}:[],A=0;A<f.length;A++){var S=A,T=f[A],T=((V,g)=>(b=>(e.dynamicTypingFunction&&e.dynamicTyping[b]===void 0&&(e.dynamicTyping[b]=e.dynamicTypingFunction(b)),(e.dynamicTyping[b]||e.dynamicTyping)===!0))(V)?g==="true"||g==="TRUE"||g!=="false"&&g!=="FALSE"&&((b=>{if(G.test(b)&&(b=parseFloat(b),N<b&&b<D))return 1})(g)?parseFloat(g):J.test(g)?new Date(g):g===""?null:g):g)(S=e.header?A>=O.length?"__parsed_extra":O[A]:S,T=e.transform?e.transform(T,S):T);S==="__parsed_extra"?(z[S]=z[S]||[],z[S].push(T)):z[S]=T}return e.header&&(A>O.length?Y("FieldMismatch","TooManyFields","Too many fields: expected "+O.length+" fields but parsed "+A,h+M):A<O.length&&Y("FieldMismatch","TooFewFields","Too few fields: expected "+O.length+" fields but parsed "+A,h+M)),z}var x;u&&(e.header||e.dynamicTyping||e.transform)&&(x=1,!u.data.length||Array.isArray(u.data[0])?(u.data=u.data.map(k),x=u.data.length):u.data=k(u.data,0),e.header&&u.meta&&(u.meta.fields=O),h+=x)}function U(){return e.header&&O.length===0}function Y(C,k,x,f){C={type:C,code:k,message:x},f!==void 0&&(C.row=f),u.errors.push(C)}R(e.step)&&(i=e.step,e.step=function(C){u=C,U()?j():(j(),u.data.length!==0&&(P+=C.data.length,e.preview&&P>e.preview?n.abort():(u.data=u.data[0],i(u,E))))}),this.parse=function(C,k,x){var f=e.quoteChar||'"',f=(e.newline||(e.newline=this.guessLineEndings(C,f)),o=!1,e.delimiter?R(e.delimiter)&&(e.delimiter=e.delimiter(C),u.meta.delimiter=e.delimiter):((f=((M,z,A,S,T)=>{var V,g,b,re;T=T||[",","	","|",";",s.RECORD_SEP,s.UNIT_SEP];for(var ie=0;ie<T.length;ie++){for(var Z,oe=T[ie],K=0,X=0,B=0,Q=(b=void 0,new he({comments:S,delimiter:oe,newline:z,preview:10}).parse(M)),te=0;te<Q.data.length;te++)A&&W(Q.data[te])?B++:(Z=Q.data[te].length,X+=Z,b===void 0?b=Z:0<Z&&(K+=Math.abs(Z-b),b=Z));0<Q.data.length&&(X/=Q.data.length-B),(g===void 0||K<=g)&&(re===void 0||re<X)&&1.99<X&&(g=K,V=oe,re=X)}return{successful:!!(e.delimiter=V),bestDelimiter:V}})(C,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=f.bestDelimiter:(o=!0,e.delimiter=s.DefaultDelimiter),u.meta.delimiter=e.delimiter),fe(e));return e.preview&&e.header&&f.preview++,t=C,n=new he(f),u=n.parse(t,k,x),j(),q?{meta:{paused:!0}}:u||{meta:{paused:!1}}},this.paused=function(){return q},this.pause=function(){q=!0,n.abort(),t=R(e.chunk)?"":t.substring(n.getCharIndex())},this.resume=function(){E.streamer._halted?(q=!1,E.streamer.parseChunk(t,!0)):setTimeout(E.resume,3)},this.aborted=function(){return p},this.abort=function(){p=!0,n.abort(),u.meta.aborted=!0,R(e.complete)&&e.complete(u),t=""},this.guessLineEndings=function(M,f){M=M.substring(0,1048576);var f=new RegExp(se(f)+"([^]*?)"+se(f),"gm"),x=(M=M.replace(f,"")).split("\r"),f=M.split(`
`),M=1<f.length&&f[0].length<x[0].length;if(x.length===1||M)return`
`;for(var z=0,A=0;A<x.length;A++)x[A][0]===`
`&&z++;return z>=x.length/2?`\r
`:"\r"}}function se(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function he(e){var t=(e=e||{}).delimiter,n=e.newline,o=e.comments,i=e.step,D=e.preview,N=e.fastMode,G=null,J=!1,E=e.quoteChar==null?'"':e.quoteChar,P=E;if(e.escapeChar!==void 0&&(P=e.escapeChar),(typeof t!="string"||-1<s.BAD_DELIMITERS.indexOf(t))&&(t=","),o===t)throw new Error("Comment character same as delimiter");o===!0?o="#":(typeof o!="string"||-1<s.BAD_DELIMITERS.indexOf(o))&&(o=!1),n!==`
`&&n!=="\r"&&n!==`\r
`&&(n=`
`);var h=0,q=!1;this.parse=function(p,O,u){if(typeof p!="string")throw new Error("Input must be a string");var W=p.length,j=t.length,U=n.length,Y=o.length,C=R(i),k=[],x=[],f=[],M=h=0;if(!p)return K();if(N||N!==!1&&p.indexOf(E)===-1){for(var z=p.split(n),A=0;A<z.length;A++){if(f=z[A],h+=f.length,A!==z.length-1)h+=n.length;else if(u)return K();if(!o||f.substring(0,Y)!==o){if(C){if(k=[],re(f.split(t)),X(),q)return K()}else re(f.split(t));if(D&&D<=A)return k=k.slice(0,D),K(!0)}}return K()}for(var S=p.indexOf(t,h),T=p.indexOf(n,h),V=new RegExp(se(P)+se(E),"g"),g=p.indexOf(E,h);;)if(p[h]===E)for(g=h,h++;;){if((g=p.indexOf(E,g+1))===-1)return u||x.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:k.length,index:h}),Z();if(g===W-1)return Z(p.substring(h,g).replace(V,E));if(E===P&&p[g+1]===P)g++;else if(E===P||g===0||p[g-1]!==P){S!==-1&&S<g+1&&(S=p.indexOf(t,g+1));var b=ie((T=T!==-1&&T<g+1?p.indexOf(n,g+1):T)===-1?S:Math.min(S,T));if(p.substr(g+1+b,j)===t){f.push(p.substring(h,g).replace(V,E)),p[h=g+1+b+j]!==E&&(g=p.indexOf(E,h)),S=p.indexOf(t,h),T=p.indexOf(n,h);break}if(b=ie(T),p.substring(g+1+b,g+1+b+U)===n){if(f.push(p.substring(h,g).replace(V,E)),oe(g+1+b+U),S=p.indexOf(t,h),g=p.indexOf(E,h),C&&(X(),q))return K();if(D&&k.length>=D)return K(!0);break}x.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:k.length,index:h}),g++}}else if(o&&f.length===0&&p.substring(h,h+Y)===o){if(T===-1)return K();h=T+U,T=p.indexOf(n,h),S=p.indexOf(t,h)}else if(S!==-1&&(S<T||T===-1))f.push(p.substring(h,S)),h=S+j,S=p.indexOf(t,h);else{if(T===-1)break;if(f.push(p.substring(h,T)),oe(T+U),C&&(X(),q))return K();if(D&&k.length>=D)return K(!0)}return Z();function re(B){k.push(B),M=h}function ie(B){var Q=0;return Q=B!==-1&&(B=p.substring(g+1,B))&&B.trim()===""?B.length:Q}function Z(B){return u||(B===void 0&&(B=p.substring(h)),f.push(B),h=W,re(f),C&&X()),K()}function oe(B){h=B,re(f),f=[],T=p.indexOf(n,h)}function K(B){if(e.header&&!O&&k.length&&!J){var Q=k[0],te=Object.create(null),pe=new Set(Q);let Ee=!1;for(let ae=0;ae<Q.length;ae++){let ee=Q[ae];if(te[ee=R(e.transformHeader)?e.transformHeader(ee,ae):ee]){let ue,Oe=te[ee];for(;ue=ee+"_"+Oe,Oe++,pe.has(ue););pe.add(ue),Q[ae]=ue,te[ee]++,Ee=!0,(G=G===null?{}:G)[ue]=ee}else te[ee]=1,Q[ae]=ee;pe.add(ee)}Ee&&console.warn("Duplicate headers found and renamed."),J=!0}return{data:k,errors:x,meta:{delimiter:t,linebreak:n,aborted:q,truncated:!!B,cursor:M+(O||0),renamedHeaders:G}}}function X(){i(K()),k=[],x=[]}},this.abort=function(){q=!0},this.getCharIndex=function(){return h}}function Te(e){var t=e.data,n=_[t.workerId],o=!1;if(t.error)n.userError(t.error,t.file);else if(t.results&&t.results.data){var i={abort:function(){o=!0,ye(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:De,resume:De};if(R(n.userStep)){for(var D=0;D<t.results.data.length&&(n.userStep({data:t.results.data[D],errors:t.results.errors,meta:t.results.meta},i),!o);D++);delete t.results}else R(n.userChunk)&&(n.userChunk(t.results,i,t.file),delete t.results)}t.finished&&!o&&ye(t.workerId,t.results)}function ye(e,t){var n=_[e];R(n.userComplete)&&n.userComplete(t),n.terminate(),delete _[e]}function De(){throw new Error("Not implemented.")}function fe(e){if(typeof e!="object"||e===null)return e;var t,n=Array.isArray(e)?[]:{};for(t in e)n[t]=fe(e[t]);return n}function ne(e,t){return function(){e.apply(t,arguments)}}function R(e){return typeof e=="function"}return s.parse=function(e,t){var n=(t=t||{}).dynamicTyping||!1;if(R(n)&&(t.dynamicTypingFunction=n,n={}),t.dynamicTyping=n,t.transform=!!R(t.transform)&&t.transform,!t.worker||!s.WORKERS_SUPPORTED)return n=null,s.NODE_STREAM_INPUT,typeof e=="string"?(e=(o=>o.charCodeAt(0)!==65279?o:o.slice(1))(e),n=new(t.download?H:F)(t)):e.readable===!0&&R(e.read)&&R(e.on)?n=new I(t):(a.File&&e instanceof File||e instanceof Object)&&(n=new v(t)),n.stream(e);(n=(()=>{var o;return!!s.WORKERS_SUPPORTED&&(o=(()=>{var i=a.URL||a.webkitURL||null,D=c.toString();return s.BLOB_URL||(s.BLOB_URL=i.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",D,")();"],{type:"text/javascript"})))})(),(o=new a.Worker(o)).onmessage=Te,o.id=m++,_[o.id]=o)})()).userStep=t.step,n.userChunk=t.chunk,n.userComplete=t.complete,n.userError=t.error,t.step=R(t.step),t.chunk=R(t.chunk),t.complete=R(t.complete),t.error=R(t.error),delete t.worker,n.postMessage({input:e,config:t,workerId:n.id})},s.unparse=function(e,t){var n=!1,o=!0,i=",",D=`\r
`,N='"',G=N+N,J=!1,E=null,P=!1,h=((()=>{if(typeof t=="object"){if(typeof t.delimiter!="string"||s.BAD_DELIMITERS.filter(function(O){return t.delimiter.indexOf(O)!==-1}).length||(i=t.delimiter),typeof t.quotes!="boolean"&&typeof t.quotes!="function"&&!Array.isArray(t.quotes)||(n=t.quotes),typeof t.skipEmptyLines!="boolean"&&typeof t.skipEmptyLines!="string"||(J=t.skipEmptyLines),typeof t.newline=="string"&&(D=t.newline),typeof t.quoteChar=="string"&&(N=t.quoteChar),typeof t.header=="boolean"&&(o=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");E=t.columns}t.escapeChar!==void 0&&(G=t.escapeChar+N),t.escapeFormulae instanceof RegExp?P=t.escapeFormulae:typeof t.escapeFormulae=="boolean"&&t.escapeFormulae&&(P=/^[=+\-@\t\r].*$/)}})(),new RegExp(se(N),"g"));if(typeof e=="string"&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return q(null,e,J);if(typeof e[0]=="object")return q(E||Object.keys(e[0]),e,J)}else if(typeof e=="object")return typeof e.data=="string"&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||E),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:typeof e.data[0]=="object"?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||typeof e.data[0]=="object"||(e.data=[e.data])),q(e.fields||[],e.data||[],J);throw new Error("Unable to serialize unrecognized input");function q(O,u,W){var j="",U=(typeof O=="string"&&(O=JSON.parse(O)),typeof u=="string"&&(u=JSON.parse(u)),Array.isArray(O)&&0<O.length),Y=!Array.isArray(u[0]);if(U&&o){for(var C=0;C<O.length;C++)0<C&&(j+=i),j+=p(O[C],C);0<u.length&&(j+=D)}for(var k=0;k<u.length;k++){var x=(U?O:u[k]).length,f=!1,M=U?Object.keys(u[k]).length===0:u[k].length===0;if(W&&!U&&(f=W==="greedy"?u[k].join("").trim()==="":u[k].length===1&&u[k][0].length===0),W==="greedy"&&U){for(var z=[],A=0;A<x;A++){var S=Y?O[A]:A;z.push(u[k][S])}f=z.join("").trim()===""}if(!f){for(var T=0;T<x;T++){0<T&&!M&&(j+=i);var V=U&&Y?O[T]:T;j+=p(u[k][V],T)}k<u.length-1&&(!W||0<x&&!M)&&(j+=D)}}return j}function p(O,u){var W,j;return O==null?"":O.constructor===Date?JSON.stringify(O).slice(1,25):(j=!1,P&&typeof O=="string"&&P.test(O)&&(O="'"+O,j=!0),W=O.toString().replace(h,G),(j=j||n===!0||typeof n=="function"&&n(O,u)||Array.isArray(n)&&n[u]||((U,Y)=>{for(var C=0;C<Y.length;C++)if(-1<U.indexOf(Y[C]))return!0;return!1})(W,s.BAD_DELIMITERS)||-1<W.indexOf(i)||W.charAt(0)===" "||W.charAt(W.length-1)===" ")?N+W+N:W)}},s.RECORD_SEP="",s.UNIT_SEP="",s.BYTE_ORDER_MARK="\uFEFF",s.BAD_DELIMITERS=["\r",`
`,'"',s.BYTE_ORDER_MARK],s.WORKERS_SUPPORTED=!L&&!!a.Worker,s.NODE_STREAM_INPUT=1,s.LocalChunkSize=10485760,s.RemoteChunkSize=5242880,s.DefaultDelimiter=",",s.Parser=he,s.ParserHandle=ce,s.NetworkStreamer=H,s.FileStreamer=v,s.StringStreamer=F,s.ReadableStreamStreamer=I,a.jQuery&&((y=a.jQuery).fn.parse=function(e){var t=e.config||{},n=[];return this.each(function(D){if(!(y(this).prop("tagName").toUpperCase()==="INPUT"&&y(this).attr("type").toLowerCase()==="file"&&a.FileReader)||!this.files||this.files.length===0)return!0;for(var N=0;N<this.files.length;N++)n.push({file:this.files[N],inputElem:this,instanceConfig:y.extend({},t)})}),o(),this;function o(){if(n.length===0)R(e.complete)&&e.complete();else{var D,N,G,J,E=n[0];if(R(e.before)){var P=e.before(E.file,E.inputElem);if(typeof P=="object"){if(P.action==="abort")return D="AbortError",N=E.file,G=E.inputElem,J=P.reason,void(R(e.error)&&e.error({name:D},N,G,J));if(P.action==="skip")return void i();typeof P.config=="object"&&(E.instanceConfig=y.extend(E.instanceConfig,P.config))}else if(P==="skip")return void i()}var h=E.instanceConfig.complete;E.instanceConfig.complete=function(q){R(h)&&h(q,E.file,E.inputElem),i()},s.parse(E.file,E.instanceConfig)}}function i(){n.splice(0,1),o()}}),r&&(a.onmessage=function(e){e=e.data,s.WORKER_ID===void 0&&e&&(s.WORKER_ID=e.workerId),typeof e.input=="string"?a.postMessage({workerId:s.WORKER_ID,results:s.parse(e.input,e.config),finished:!0}):(a.File&&e.input instanceof File||e.input instanceof Object)&&(e=s.parse(e.input,e.config))&&a.postMessage({workerId:s.WORKER_ID,results:e,finished:!0})}),(H.prototype=Object.create(w.prototype)).constructor=H,(v.prototype=Object.create(w.prototype)).constructor=v,(F.prototype=Object.create(F.prototype)).constructor=F,(I.prototype=Object.create(w.prototype)).constructor=I,s})})(le)),le.exports}var Ae=ve();const de=ke(Ae);function Ie(l){let d=l["Date created"].values.map(r=>{const _=r instanceof Date?r:new Date(r);return _e(_)}),c=l.COMPLETA.values.map(r=>String(r));return new $({"Date created":d,COMPLETA:c}).groupby(["Date created","COMPLETA"]).col(["COMPLETA"]).count().rename({COMPLETA_count:"Cantidad"})}function Re(l){if(!l||l.shape[0]===0)return new $({"Cambio Completa":[1,-1],Cantidad:[0,0]});const d=["ROLL_ID","Turno","COMPLETA"];for(const m of d)if(!l.columns.includes(m))return console.warn(`[checkChangeStatus] Falta columna '${m}'`),new $({"Cambio Completa":[1,-1],Cantidad:[0,0]});const c=new Map,a=new Map;for(let m=0;m<l.shape[0];m++){const s=l.at(m,"ROLL_ID"),w=Number(l.at(m,"Turno")),H=l.at(m,"COMPLETA");w===1?c.set(s,H):w===0&&a.set(s,H)}const y=Array.from(c.keys()),L=Array.from(a.keys());let r=0,_=0;for(let m=0;m<y.length;m++){const s=y[m],w=c.get(s);if(!a.has(s))w==="Saldo"&&(r=r+1);else{const H=a.get(s);w==="Saldo"&&H==="Completa"&&(r=r+1)}}for(let m=0;m<L.length;m++){const s=L[m];c.has(s)||a.get(s)==="Saldo"&&(_=_-1)}return[r,_]}async function Se(l){const d=me(l);return[...new Set(d.map(c=>c.name))]}function _e(l){const d=l.getFullYear(),c=String(l.getMonth()+1).padStart(2,"0"),a=String(l.getDate()).padStart(2,"0");return`${d}-${c}-${a}`}function me(l){return l.filter(d=>d.name.toLowerCase().endsWith(".csv")).map(d=>{const c=new Date(d.lastModified);return{file:d,name:d.name,date:c,day:_e(c),hour:c.getHours(),minute:c.getMinutes(),lastModified:d.lastModified}}).sort((d,c)=>{const a=d.lastModified;return c.lastModified-a})}async function Pe(l){const d=me(l);if(d.length===0)return[];const c=d[0];let a;if(c.hour>=21)a=d.find(y=>y.day===c.day&&y.hour<21);else if(c.hour<=6){const y=new Date(c.date);y.setDate(y.getDate()-1);const L=_e(y);a=d.find(r=>r.day===L&&r.hour<21)}else c.hour<13?a=d.find(y=>y.day===c.day&&y.hour<6):a=d.find(y=>y.day===c.day&&y.hour<13);return!a&&d.length>1&&(a=d[1]),[c.name,a?a.name:null].filter(Boolean)}async function xe(l){if(!l||l.length===0)return new $([]);let d=await l.text();d=de.parse(d,{header:!0,skipEmptyLines:!0}),d=d.data.map(r=>({...r})),d=d.filter(r=>r.LOCATION!=="ULOG"&&r.LOCATION!=="DPBQ"&&r.ESTADO==="STOCK"&&r.DEPO==="Planta SFM"&&r.COMPLETA==="Saldo"),d=d.map(r=>({ROLL_ID:r.ROLL_ID,PAPER_CODE:r.PAPER_CODE,WIDTH:r.WIDTH,ESTADO:r.ESTADO,COMPLETA:r.COMPLETA}));const c=["PAPER_CODE","WIDTH","ROLL_ID"],a=new $(d).loc({columns:c.filter(r=>new $(d).columns.includes(r))});return a.shape[0]===0?new $([],{columns:["PAPER_CODE","WIDTH","Cantidad"]}):a.groupby(["PAPER_CODE","WIDTH"]).col(["ROLL_ID"]).count().rename({ROLL_ID_count:"Cantidad"})}async function Me(l){const d=[];for(const c of l)try{const a=await c.text(),y=de.parse(a,{header:!0,skipEmptyLines:!0});if(!y.data||y.data.length===0)continue;const L=c.lastModifiedDate||c.lastModified;if(!L)continue;let r=L instanceof Date?L:new Date(L);if(isNaN(r.getTime()))continue;r=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds());let _=y.data.map(m=>({...m,"Date created":r}));_=_.filter(m=>m.LOCATION!=="ULOG"&&m.LOCATION!=="DPBQ"&&m.ESTADO==="STOCK"&&m.DEPO==="Planta SFM"),_=_.map(m=>({ROLL_ID:m.ROLL_ID,PAPER_CODE:m.PAPER_CODE,WIDTH:m.WIDTH,ESTADO:m.ESTADO,COMPLETA:m.COMPLETA,"Date created":m["Date created"]})),_.length>0&&d.push(new $(_))}catch(a){console.error(`Error leyendo archivo ${c.name}:`,a);continue}return d.length===0?new $([],{columns:["ROLL_ID","PAPER_CODE","WIDTH","ESTADO","COMPLETA","Date created"]}):ge({dfList:d,axis:0})}async function Fe(l,d=20){let c=await Se(l);if(c=me(l.filter(r=>c.includes(r.name))),c.length===0)return new $([]);const a=new Map;for(const r of c){const _=a.get(r.day);if(_?r.lastModified>_.lastModified&&a.set(r.day,r):a.set(r.day,r),a.size>=d)break}const y=Array.from(a.values()).sort((r,_)=>_.lastModified-r.lastModified).map(r=>l.find(_=>_.name===r.name)).filter(Boolean);if(y.sort((r,_)=>_.lastModified-r.lastModified),y.length===0)return new $([]);const L=[];for(const r of y)try{const _=await r.text(),m=de.parse(_,{header:!0,skipEmptyLines:!0});if(!m.data||m.data.length===0)continue;const s=r.lastModifiedDate||r.lastModified;if(!s)continue;let w=s instanceof Date?s:new Date(s);if(isNaN(w.getTime()))continue;w=new Date(w.getFullYear(),w.getMonth(),w.getDate());let H=m.data.map(v=>({...v,"Date created":w}));H=H.filter(v=>v.LOCATION!=="ULOG"&&v.LOCATION!=="DPBQ"&&v.ESTADO==="STOCK"&&v.DEPO==="Planta SFM"),H=H.map(v=>({ROLL_ID:v.ROLL_ID,PAPER_CODE:v.PAPER_CODE,WIDTH:v.WIDTH,ESTADO:v.ESTADO,COMPLETA:v.COMPLETA,"Date created":v["Date created"]})),H.length>0&&L.push(new $(H))}catch(_){console.error(`Error leyendo archivo ${r.name}:`,_);continue}return L.length===0?new $([],{columns:["ROLL_ID","PAPER_CODE","WIDTH","ESTADO","COMPLETA","Date created"]}):ge({dfList:L,axis:0})}function je(l){if(l=new $(l.values,{columns:l.columns}),!l.columns.includes("Date created"))throw console.error("[addTurn] La columna 'Date created' no existe en el DataFrame",l.columns),new Error("La columna 'Date created' no existe en el DataFrame");let d=l["Date created"].values.map(r=>{const _=r instanceof Date?r:new Date(r);return!isNaN(_.getTime())});d.some(r=>!r)&&(console.warn("[addTurn] Filas con 'Date created' inválido serán eliminadas:",d.filter(r=>!r).length),l=l.loc({rows:d}));const c=l["Date created"].values;if(!c||c.length===0)throw console.error("[addTurn] La columna 'Date created' está vacía tras limpiar"),new Error("La columna 'Date created' está vacía");const a=c.map(r=>r instanceof Date?r:new Date(r)),y=a.reduce((r,_)=>_>r?_:r,a[0]);let L=a.map(r=>r.getTime()===y.getTime()?1:0);if(L=L.map(r=>r===1?1:0),L.length!==l.shape[0])throw console.error(`[addTurn] Desajuste de longitud tras limpiar: filas=${l.shape[0]}, turno=${L.length}`),new Error("Desajuste de longitud al agregar columna 'Turno'");return l=l.resetIndex({inplace:!1}),l.addColumn("Turno",L,{inplace:!0}),l}async function Ne(l){if(!l||l.length===0)return null;const d=l.slice().sort((v,F)=>{const I=v.lastModifiedDate||v.lastModified;return(F.lastModifiedDate||F.lastModified)-I}),c=d[0],a=d[d.length-1],y=async v=>{let F=await v.text();return F=de.parse(F,{header:!0,skipEmptyLines:!0}),F=F.data.map(I=>({...I})),F=F.filter(I=>I.LOCATION!=="ULOG"&&I.LOCATION!=="DPBQ"&&I.ESTADO==="STOCK"&&I.DEPO==="Planta SFM"&&I.COMPLETA==="Saldo"),F=F.map(I=>({ROLL_ID:I.ROLL_ID,PAPER_CODE:I.PAPER_CODE,WIDTH:I.WIDTH,ESTADO:I.ESTADO,COMPLETA:I.COMPLETA})),new $(F)},L=await y(c),r=await y(a);if(L.shape[0]===0||r.shape[0]===0)return null;const _=(v,F)=>{const I=Array(v.shape[0]).fill(F);return v=v.resetIndex({inplace:!1}),v.addColumn("Turno",I,{inplace:!0}),v},m=_(L,1),s=_(r,0),w=ge({dfList:[m,s],axis:0});return Re(w)}export{je as addTurn,Re as checkChangeStatus,Ie as countItemsbyDate,Se as getAllData,Fe as getLastNDays,xe as getQuickData,Ne as getTurnResume,Pe as getTurns,Me as readDataFrame,me as sortFilesByLastModified};
